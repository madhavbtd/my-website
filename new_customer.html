<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>New/Edit Customer</title>
    <link rel="stylesheet" href="css/new_customer.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" integrity="sha512-9usAa10IRO0HhonpyAIVpjrylPvoDwiPUiKdWk5t3PyolY1cOd4DSE0Ga+ri4AuTroPR5aQvXU9xC6qOPnzFeg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>
<body>
     <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
        import { getFirestore, collection, addDoc, doc, updateDoc, deleteDoc, onSnapshot, getDocs, query, where, getDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js"; // getDoc जोड़ा गया

        const firebaseConfig = {
          apiKey: "AIzaSyBQj5rQmE77kKKGYixP8y3Hcimz8tiAqzQ",
          authDomain: "madhav-multyprint.firebaseapp.com",
          projectId: "madhav-multyprint",
          storageBucket: "madhav-multyprint.firebasestorage.app",
          messagingSenderId: "104988349637",
          appId: "1:104988349637:web:faf045b77c6786a4e70cac"
        };

        try {
            let app;
            if (!window.firebaseAppInitialized) {
                 app = initializeApp(firebaseConfig);
                 window.firebaseAppInitialized = true;
                 console.log("Firebase initialized on new_customer page.");
            } else {
                 console.log("Firebase already initialized.");
            }
            const db = window.db || getFirestore(app || undefined);

            window.db = db;
            window.collection = collection;
            window.addDoc = addDoc;
            window.doc = doc;
            window.updateDoc = updateDoc; // updateDoc को ग्लोबल बनाया
            window.deleteDoc = deleteDoc;
            window.onSnapshot = onSnapshot;
            window.getDocs = getDocs;
            window.query = query;
            window.where = where;
            window.getDoc = getDoc; // getDoc को ग्लोबल बनाया
            console.log("Firebase functions are available globally.");

        } catch (e) {
            console.error("Firebase initialization error:", e);
             if (!window.db) {
                 console.error("Critical: Firebase could not be initialized.");
                 alert("Database connection error!");
             }
        }
    </script>

    <div class="container">
        <div class="header" id="formHeader">
            New Customer Information
        </div>

        <form id="newCustomerForm">
            <input type="hidden" id="editCustomerId" name="editCustomerId">

            <div class="section-title">1. Customer Details</div>
            <div class="form-group">
                <label for="full_name">Full Name:</label>
                <input type="text" id="full_name" name="full_name" placeholder="Enter Full Name" autocomplete="off" required>
            </div>
            <div class="form-group">
                <label for="billing_address">Billing Address:</label>
                <input type="text" id="billing_address" name="billing_address" placeholder="Enter Billing Address">
            </div>
            <div class="form-group">
                <label for="city">City:</label>
                <input type="text" id="city" name="city" placeholder="Enter City">
            </div>
            <div class="form-group">
                <label for="state">State:</label>
                <input type="text" id="state" name="state" placeholder="Enter State">
            </div>
            <div class="form-group">
                <label for="pin_code">PIN Code:</label>
                <input type="text" id="pin_code" name="pin_code" placeholder="Enter PIN Code">
            </div>
            <div class="form-group">
                <label for="country">Country:</label>
                <input type="text" id="country" name="country" value="India" readonly>
            </div>
            <div class="form-group">
                <label for="email_id">Email ID:</label>
                <input type="email" id="email_id" name="email_id" placeholder="Enter Email ID">
            </div>
            <div class="form-group">
                <label for="whatsapp_no">WhatsApp No:</label>
                <input type="text" id="whatsapp_no" name="whatsapp_no" placeholder="Enter WhatsApp No" required>
            </div>
            <div class="form-group">
                <label for="contact_no">Contact No:</label>
                <input type="text" id="contact_no" name="contact_no" placeholder="Enter Contact No">
            </div>

            <div class="section-title">2. Tax Details</div>
            <div class="form-group">
                <label for="pan_no">PAN No.:</label>
                <input type="text" id="pan_no" name="pan_no" placeholder="Enter PAN No.">
            </div>
            <div class="form-group">
                <label for="gstin">GSTIN:</label>
                <input type="text" id="gstin" name="gstin" placeholder="Enter GSTIN">
            </div>
            <div class="form-group">
                <label>GST Type:</label>
                <div class="gst-type-group">
                    <label><input type="radio" name="gst_type" value="Registered"> Registered</label>
                    <label><input type="radio" name="gst_type" value="Unregistered"> Unregistered</label>
                    <label><input type="radio" name="gst_type" value="Composite"> Composite</label>
                </div>
            </div>
            <div class="form-group">
                <label for="composite_trade_name">Composite Trade Name:</label>
                <input type="text" id="composite_trade_name" name="composite_trade_name" placeholder="Enter Composite Trade Name">
            </div>

            <div class="button-container">
                 <button type="submit" class="save-button" id="saveCustomerBtn"><i class="fas fa-save"></i> Save</button>
                 <button type="button" onclick="window.location.href='customer_management.html'" style="background-color:#6c757d; margin-left: 10px;">Cancel</button> </div>
        </form> </div>

    <script src="js/new_customer.js" type="module"></script>

</body>
</html>